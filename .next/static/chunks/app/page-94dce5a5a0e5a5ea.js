(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3071:function(e,a,s){Promise.resolve().then(s.bind(s,6225))},6225:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return M}});var t=s(7437),l=s(2265),r=s(1872),i=s(9883),n=s(2882),o=s(734),d=s(1138),c=s(9409),p=s(7972),m=s(9168);function x(e){let{conversations:a,currentConversationId:s,settings:r,onNewChat:x,onSelectConversation:u,onDeleteConversation:g,onRenameConversation:h,onOpenSettings:b}=e,[f,j]=l.useState(null),[y,v]=l.useState(""),N=e=>{j(e.id),v(e.title)},w=()=>{f&&y.trim()&&h(f,y.trim()),j(null),v("")},C=()=>{j(null),v("")},k=e=>{let a=Math.floor((new Date().getTime()-e.getTime())/864e5);return 0===a?"Today":1===a?"Yesterday":a<7?"".concat(a," days ago"):a<30?"".concat(Math.floor(a/7)," weeks ago"):e.toLocaleDateString()};return(0,t.jsxs)("div",{className:"w-80 bg-apple-gray-50 border-r border-apple-gray-200 flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-apple-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-apple-gray-900",children:"ChatCDC"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-apple-green-500 rounded-full animate-pulse-subtle"}),(0,t.jsx)("span",{className:"text-xs text-apple-gray-500 font-medium",children:r.model.toUpperCase()})]})]}),(0,t.jsxs)("button",{onClick:x,className:"w-full btn-primary flex items-center justify-center gap-2 py-3",children:[(0,t.jsx)(i.Z,{size:18}),"New Chat"]})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:(0,t.jsx)("div",{className:"space-y-2",children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-8 text-apple-gray-500",children:[(0,t.jsx)(n.Z,{size:48,className:"mx-auto mb-3 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"No conversations yet"}),(0,t.jsx)("p",{className:"text-xs mt-1",children:"Start a new chat to begin"})]}):a.map(e=>(0,t.jsx)("div",{className:"group relative rounded-xl transition-all duration-200 ".concat(s===e.id?"bg-apple-blue-500 text-white shadow-lg":"hover:bg-white hover:shadow-sm"),children:f===e.id?(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)("input",{type:"text",value:y,onChange:e=>v(e.target.value),onKeyDown:e=>{"Enter"===e.key&&w(),"Escape"===e.key&&C()},onBlur:w,className:"w-full bg-transparent border-b border-current outline-none text-sm",autoFocus:!0})}):(0,t.jsx)("div",{onClick:()=>u(e.id),className:"p-3 cursor-pointer",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-sm truncate mb-1",children:e.title}),(0,t.jsxs)("p",{className:"text-xs opacity-70",children:[k(e.updatedAt)," â€¢ ",e.messages.length," messages"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 ml-2",children:[(0,t.jsx)("button",{onClick:a=>{a.stopPropagation(),N(e)},className:"p-1 rounded hover:bg-black/10 transition-colors duration-200",title:"Rename",children:(0,t.jsx)(o.Z,{size:12})}),(0,t.jsx)("button",{onClick:a=>{a.stopPropagation(),g(e.id)},className:"p-1 rounded hover:bg-black/10 transition-colors duration-200 text-apple-red-500",title:"Delete",children:(0,t.jsx)(d.Z,{size:12})})]})]})})},e.id))})}),(0,t.jsxs)("div",{className:"p-4 border-t border-apple-gray-200 space-y-2",children:[(0,t.jsxs)("button",{onClick:b,className:"sidebar-item w-full justify-start",children:[(0,t.jsx)(c.Z,{size:18}),(0,t.jsx)("span",{children:"Settings"})]}),(0,t.jsxs)("div",{className:"sidebar-item w-full justify-start",children:[(0,t.jsx)(p.Z,{size:18}),(0,t.jsx)("span",{children:"Profile"})]}),(0,t.jsxs)("div",{className:"sidebar-item w-full justify-start",children:[(0,t.jsx)(m.Z,{size:18}),(0,t.jsx)("span",{children:"Upgrade to Pro"})]})]})]})}var u=s(272),g=s(2369),h=s(3523),b=s(8956);function f(e){let{settings:a,onSettingsChange:s,currentTitle:r}=e,[i,o]=l.useState(!1),[d,c]=l.useState(!1),p=e=>{switch(e){case"gpt-5":default:return(0,t.jsx)(u.Z,{className:"text-purple-500",size:16});case"gpt-5-mini":return(0,t.jsx)(g.Z,{className:"text-blue-500",size:16});case"gpt-5-nano":return(0,t.jsx)(n.Z,{className:"text-green-500",size:16})}};return(0,t.jsx)("header",{className:"bg-white border-b border-apple-gray-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between max-w-full",children:[(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)("h1",{className:"text-lg font-semibold text-apple-gray-900 truncate",children:r||"New Chat"})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>o(!i),className:"flex items-center gap-2 px-3 py-2 bg-apple-gray-100 hover:bg-apple-gray-200 rounded-xl transition-colors duration-200",children:[p(a.model),(0,t.jsx)("span",{className:"font-medium text-sm",children:a.model.toUpperCase()}),(0,t.jsx)(h.Z,{size:16,className:"transition-transform duration-200 ".concat(i?"rotate-180":"")})]}),i&&(0,t.jsx)("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-apple-gray-200 py-2 z-50",children:[{id:"gpt-5",name:"GPT-5",description:"Most capable model"},{id:"gpt-5-mini",name:"GPT-5 Mini",description:"Fast and efficient"},{id:"gpt-5-nano",name:"GPT-5 Nano",description:"Ultra-fast responses"}].map(e=>(0,t.jsx)("button",{onClick:()=>{s({...a,model:e.id}),o(!1)},className:"w-full px-4 py-3 text-left hover:bg-apple-gray-50 transition-colors duration-200 ".concat(a.model===e.id?"bg-apple-blue-50 text-apple-blue-600":""),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[p(e.id),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-apple-gray-500",children:e.description})]})]})},e.id))})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>c(!d),className:"flex items-center gap-2 px-3 py-2 text-apple-gray-600 hover:bg-apple-gray-100 rounded-xl transition-colors duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[a.enableWebSearch&&(0,t.jsx)(b.Z,{size:14,className:"text-apple-blue-500"}),(0,t.jsx)("span",{className:"text-sm font-medium capitalize",children:a.verbosity})]}),(0,t.jsx)(h.Z,{size:16,className:"transition-transform duration-200 ".concat(d?"rotate-180":"")})]}),d&&(0,t.jsx)("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-apple-gray-200 p-4 z-50",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-apple-gray-700 mb-2",children:"Response Style"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{id:"low",name:"Concise",description:"Short and direct"},{id:"medium",name:"Balanced",description:"Moderate detail"},{id:"high",name:"Detailed",description:"Comprehensive responses"}].map(e=>(0,t.jsxs)("button",{onClick:()=>s({...a,verbosity:e.id}),className:"p-2 rounded-lg text-xs font-medium transition-colors duration-200 ".concat(a.verbosity===e.id?"bg-apple-blue-500 text-white":"bg-apple-gray-100 hover:bg-apple-gray-200 text-apple-gray-700"),children:[(0,t.jsx)("div",{children:e.name}),(0,t.jsx)("div",{className:"text-xs opacity-70",children:e.description})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-apple-gray-700 mb-2",children:"Reasoning Effort"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{id:"minimal",name:"Minimal",description:"Quick responses"},{id:"low",name:"Low",description:"Basic reasoning"},{id:"medium",name:"Medium",description:"Moderate reasoning"},{id:"high",name:"High",description:"Deep reasoning"}].map(e=>(0,t.jsxs)("button",{onClick:()=>s({...a,reasoningEffort:e.id}),className:"p-2 rounded-lg text-xs font-medium transition-colors duration-200 ".concat(a.reasoningEffort===e.id?"bg-apple-blue-500 text-white":"bg-apple-gray-100 hover:bg-apple-gray-200 text-apple-gray-700"),children:[(0,t.jsx)("div",{children:e.name}),(0,t.jsx)("div",{className:"text-xs opacity-70",children:e.description})]},e.id))})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("label",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-apple-gray-700",children:"Web Search"}),(0,t.jsx)("p",{className:"text-xs text-apple-gray-500",children:"Allow access to current information"})]}),(0,t.jsx)("button",{onClick:()=>s({...a,enableWebSearch:!a.enableWebSearch}),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ".concat(a.enableWebSearch?"bg-apple-blue-500":"bg-apple-gray-300"),children:(0,t.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200 ".concat(a.enableWebSearch?"translate-x-6":"translate-x-1")})})]})})]})})]})]})]})})}var j=s(9868),y=s(4658),v=s(6224),N=s(5432),w=s(5749),C=s(815);function k(e){let{message:a,onFeedback:s,onCopy:l,onRegenerate:r}=e,i="user"===a.role;return a.isTyping?(0,t.jsx)("div",{className:"flex justify-start mb-6",children:(0,t.jsx)("div",{className:"message-bubble assistant-message",children:(0,t.jsxs)("div",{className:"typing-indicator flex gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-apple-gray-400 rounded-full"}),(0,t.jsx)("span",{className:"w-2 h-2 bg-apple-gray-400 rounded-full"}),(0,t.jsx)("span",{className:"w-2 h-2 bg-apple-gray-400 rounded-full"})]})})}):(0,t.jsx)("div",{className:"flex ".concat(i?"justify-end":"justify-start"," mb-6 group"),children:(0,t.jsxs)("div",{className:"message-bubble ".concat(i?"user-message":"assistant-message"),children:[a.images&&a.images.length>0&&(0,t.jsx)("div",{className:"mb-3 grid grid-cols-2 gap-2",children:a.images.map((e,a)=>(0,t.jsx)("img",{src:e,alt:"Uploaded image ".concat(a+1),className:"rounded-lg max-w-full h-auto"},a))}),(0,t.jsx)("div",{className:"prose prose-sm max-w-none",children:i?(0,t.jsx)("p",{className:"text-white m-0 whitespace-pre-wrap",children:a.content}):(0,t.jsx)(w.UG,{remarkPlugins:[C.Z],className:"text-apple-gray-900 [&>*:first-child]:mt-0 [&>*:last-child]:mb-0",components:{code(e){let{node:a,inline:s,className:l,children:r,...i}=e;return s?(0,t.jsx)("code",{className:"bg-apple-gray-200 px-1 py-0.5 rounded text-sm",...i,children:r}):(0,t.jsx)("pre",{className:"overflow-auto rounded-lg p-3",children:(0,t.jsx)("code",{className:l,...i,children:r})})},table(e){let{children:a,...s}=e;return(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsx)("table",{className:"min-w-full border-collapse",...s,children:a})})}},children:a.content})}),!i&&(0,t.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-apple-gray-200 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>s(a.id,"up"),className:"p-1.5 rounded-lg transition-colors duration-200 ".concat("up"===a.feedback?"bg-apple-green-500 text-white":"hover:bg-apple-gray-200 text-apple-gray-600"),children:(0,t.jsx)(j.Z,{size:14})}),(0,t.jsx)("button",{onClick:()=>s(a.id,"down"),className:"p-1.5 rounded-lg transition-colors duration-200 ".concat("down"===a.feedback?"bg-apple-red-500 text-white":"hover:bg-apple-gray-200 text-apple-gray-600"),children:(0,t.jsx)(y.Z,{size:14})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>l(a.content),className:"p-1.5 rounded-lg hover:bg-apple-gray-200 text-apple-gray-600 transition-colors duration-200",title:"Copy message",children:(0,t.jsx)(v.Z,{size:14})}),r&&(0,t.jsx)("button",{onClick:()=>r(a.id),className:"p-1.5 rounded-lg hover:bg-apple-gray-200 text-apple-gray-600 transition-colors duration-200",title:"Regenerate response",children:(0,t.jsx)(N.Z,{size:14})})]})]})]})})}function S(e){let{messages:a,isLoading:s,onFeedback:r,onCopy:i,onRegenerate:n}=e,o=(0,l.useRef)(null),d=(0,l.useRef)(null),c=()=>{var e;null===(e=o.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return((0,l.useEffect)(()=>{c()},[a]),0===a.length)?(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-apple-gray-50 to-white",children:(0,t.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-apple-blue-500 to-apple-blue-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:(0,t.jsx)("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-apple-gray-900 mb-3",children:"Welcome to ChatCDC"}),(0,t.jsx)("p",{className:"text-apple-gray-600 mb-6 leading-relaxed",children:"Your intelligent AI assistant powered by GPT-5. Ask me anything, upload images, or start a conversation to explore the possibilities."}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl shadow-sm border border-apple-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-apple-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-apple-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsx)("span",{className:"text-apple-gray-700",children:"Advanced reasoning capabilities"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl shadow-sm border border-apple-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-apple-green-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-apple-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})}),(0,t.jsx)("span",{className:"text-apple-gray-700",children:"Image analysis and understanding"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl shadow-sm border border-apple-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-apple-red-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-apple-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,t.jsx)("span",{className:"text-apple-gray-700",children:"Code generation and debugging"})]})]})]})}):(0,t.jsx)("div",{className:"flex-1 flex flex-col bg-gradient-to-br from-apple-gray-50 to-white",children:(0,t.jsxs)("div",{ref:d,className:"flex-1 overflow-y-auto custom-scrollbar px-6 py-6",children:[(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[a.map(e=>(0,t.jsx)(k,{message:e,onFeedback:r,onCopy:i,onRegenerate:n},e.id)),s&&(0,t.jsx)(k,{message:{id:"typing",role:"assistant",content:"",timestamp:new Date,isTyping:!0},onFeedback:()=>{},onCopy:()=>{}})]}),(0,t.jsx)("div",{ref:o})]})})}var z=s(2549),D=s(8438),Z=s(6020);function E(e){let{onSendMessage:a,disabled:s=!1,placeholder:r="Type your message..."}=e,[i,n]=(0,l.useState)(""),[o,d]=(0,l.useState)([]),c=(0,l.useRef)(null),p=(0,l.useRef)(null),m=(0,l.useCallback)(e=>{e.preventDefault(),(i.trim()||o.length>0)&&(a(i.trim(),o.length>0?o:void 0),n(""),d([]),c.current&&(c.current.style.height="auto"))},[i,o,a]),x=(0,l.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m(e))},[m]),u=(0,l.useCallback)(e=>{n(e.target.value),c.current&&(c.current.style.height="auto",c.current.style.height="".concat(Math.min(c.current.scrollHeight,120),"px"))},[]),g=(0,l.useCallback)(e=>{Array.from(e.target.files||[]).forEach(e=>{if(e.type.startsWith("image/")){let a=new FileReader;a.onload=e=>{var a;(null===(a=e.target)||void 0===a?void 0:a.result)&&d(a=>[...a,e.target.result])},a.readAsDataURL(e)}}),p.current&&(p.current.value="")},[]),h=(0,l.useCallback)(e=>{d(a=>a.filter((a,s)=>s!==e))},[]);return(0,t.jsx)("div",{className:"bg-white border-t border-apple-gray-200 p-4",children:(0,t.jsxs)("form",{onSubmit:m,className:"max-w-4xl mx-auto",children:[o.length>0&&(0,t.jsx)("div",{className:"mb-4 flex flex-wrap gap-2",children:o.map((e,a)=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:e,alt:"Upload preview ".concat(a+1),className:"w-16 h-16 object-cover rounded-lg border border-apple-gray-200"}),(0,t.jsx)("button",{type:"button",onClick:()=>h(a),className:"absolute -top-2 -right-2 w-6 h-6 bg-apple-red-500 text-white rounded-full flex items-center justify-center hover:bg-apple-red-600 transition-colors duration-200",children:(0,t.jsx)(z.Z,{size:12})})]},a))}),(0,t.jsxs)("div",{className:"relative flex items-end gap-3 bg-apple-gray-50 rounded-2xl p-3 border border-apple-gray-200 focus-within:border-apple-blue-500 focus-within:ring-2 focus-within:ring-apple-blue-500/20 transition-all duration-200",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.click()},disabled:s,className:"flex-shrink-0 p-2 text-apple-gray-500 hover:text-apple-blue-500 hover:bg-apple-blue-50 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Upload image",children:(0,t.jsx)(D.Z,{size:20})}),(0,t.jsx)("input",{ref:p,type:"file",accept:"image/*",multiple:!0,onChange:g,className:"hidden"}),(0,t.jsx)("textarea",{ref:c,value:i,onChange:u,onKeyDown:x,placeholder:r,disabled:s,className:"flex-1 bg-transparent border-none outline-none resize-none min-h-[24px] max-h-[120px] text-apple-gray-900 placeholder-apple-gray-500 disabled:opacity-50",rows:1}),(0,t.jsx)("button",{type:"submit",disabled:s||!i.trim()&&0===o.length,className:"flex-shrink-0 p-2 bg-apple-blue-500 text-white rounded-xl hover:bg-apple-blue-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-apple-blue-500",children:(0,t.jsx)(Z.Z,{size:20})})]}),(0,t.jsx)("div",{className:"mt-2 text-xs text-apple-gray-500 text-center",children:"Press Enter to send, Shift+Enter for new line"})]})})}let A={model:"gpt-5",verbosity:"medium",reasoningEffort:"minimal",enableWebSearch:!1};function M(){let[e,a]=(0,l.useState)([]),[s,i]=(0,l.useState)(null),[n,o]=(0,l.useState)(A),[d,c]=(0,l.useState)(!1),[p,m]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("chatcdc-conversations"),s=localStorage.getItem("chatcdc-settings");if(e)try{let s=JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),messages:e.messages.map(e=>({...e,timestamp:new Date(e.timestamp)}))}));a(s),s.length>0&&i(s[0].id)}catch(e){console.error("Error loading conversations:",e)}if(s)try{o(JSON.parse(s))}catch(e){console.error("Error loading settings:",e)}},[]);let u=(0,l.useCallback)(e=>{localStorage.setItem("chatcdc-conversations",JSON.stringify(e))},[]),g=(0,l.useCallback)(e=>{localStorage.setItem("chatcdc-settings",JSON.stringify(e))},[]),h=(0,l.useCallback)(()=>e.find(e=>e.id===s)||null,[e,s]),b=(0,l.useCallback)(e=>e.split(" ").slice(0,6).join(" ")+(e.split(" ").length>6?"...":""),[]),j=(0,l.useCallback)(()=>{let s={id:(0,r.Z)(),title:"New Chat",messages:[],createdAt:new Date,updatedAt:new Date},t=[s,...e];a(t),i(s.id),m(null),u(t)},[e,u]),y=(0,l.useCallback)(e=>{i(e),m(null)},[]),v=(0,l.useCallback)(t=>{let l=e.filter(e=>e.id!==t);a(l),s===t&&i(l.length>0?l[0].id:null),u(l)},[e,s,u]),N=(0,l.useCallback)((s,t)=>{let l=e.map(e=>e.id===s?{...e,title:t,updatedAt:new Date}:e);a(l),u(l)},[e,u]),w=(0,l.useCallback)(e=>{o(e),g(e)},[g]),C=(0,l.useCallback)(async(s,t)=>{if(!s.trim()&&(!t||0===t.length))return;let l=h();if(!l){let t=[l={id:(0,r.Z)(),title:b(s),messages:[],createdAt:new Date,updatedAt:new Date},...e];a(t),i(l.id),u(t)}let o={id:(0,r.Z)(),role:"user",content:s,timestamp:new Date,images:t},d=0===l.messages.length?b(s):l.title,x={...l,title:d,messages:[...l.messages,o],updatedAt:new Date},g=e.map(e=>e.id===x.id?x:e);a(g),u(g),c(!0);try{let l=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,settings:n,images:t,previousResponseId:p})});if(!l.ok)throw Error("HTTP error! status: ".concat(l.status));let i=await l.json();if(i.error)throw Error(i.error);let o={id:(0,r.Z)(),role:"assistant",content:i.content,timestamp:new Date},d={...x,messages:[...x.messages,o],updatedAt:new Date},c=e.map(e=>e.id===d.id?d:e);a(c),u(c),m(i.responseId)}catch(i){console.error("Error sending message:",i);let s={id:(0,r.Z)(),role:"assistant",content:"Sorry, I encountered an error: ".concat(i instanceof Error?i.message:"Unknown error",". Please try again."),timestamp:new Date},t={...x,messages:[...x.messages,s],updatedAt:new Date},l=e.map(e=>e.id===t.id?t:e);a(l),u(l)}finally{c(!1)}},[h,e,b,u,n,p]),k=(0,l.useCallback)((s,t)=>{let l=e.map(e=>({...e,messages:e.messages.map(e=>e.id===s?{...e,feedback:e.feedback===t?null:t}:e)}));a(l),u(l)},[e,u]),z=(0,l.useCallback)(async e=>{try{await navigator.clipboard.writeText(e)}catch(e){console.error("Failed to copy:",e)}},[]),D=(0,l.useCallback)(async s=>{let t=h();if(!t)return;let l=t.messages.findIndex(e=>e.id===s);if(-1===l||0===l)return;let r=t.messages[l-1];if("user"!==r.role)return;let i=t.messages.slice(0,l),n={...t,messages:i,updatedAt:new Date},o=e.map(e=>e.id===n.id?n:e);a(o),u(o),await C(r.content,r.images)},[h,e,u,C]),Z=h(),M=(null==Z?void 0:Z.messages)||[];return(0,t.jsxs)("div",{className:"flex h-screen bg-white",children:[(0,t.jsx)(x,{conversations:e,currentConversationId:s,settings:n,onNewChat:j,onSelectConversation:y,onDeleteConversation:v,onRenameConversation:N,onOpenSettings:()=>{}}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(f,{settings:n,onSettingsChange:w,currentTitle:null==Z?void 0:Z.title}),(0,t.jsx)(S,{messages:M,isLoading:d,onFeedback:k,onCopy:z,onRegenerate:D}),(0,t.jsx)(E,{onSendMessage:C,disabled:d,placeholder:"Type your message..."})]})]})}}},function(e){e.O(0,[465,971,938,744],function(){return e(e.s=3071)}),_N_E=e.O()}]);