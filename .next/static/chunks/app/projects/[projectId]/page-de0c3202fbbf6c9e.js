(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[110],{3067:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6637:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},6264:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2882:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},6020:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,t(2898).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},62:function(e,s,t){Promise.resolve().then(t.bind(t,4235))},4235:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return m}});var a=t(7437),r=t(2265),n=t(4033),l=t(6264),i=t(3067),o=t(6637),c=t(2882),d=t(6020),u=t(1396),p=t.n(u),x=t(1654);function m(){let e=(0,n.useParams)(),s=(0,n.useRouter)(),t=e.projectId,[u,m]=(0,r.useState)(null),[h,g]=(0,r.useState)([]),[f,y]=(0,r.useState)(!0),[j,b]=(0,r.useState)(null),[N,v]=(0,r.useState)(""),[w,_]=(0,r.useState)(!1),k=(0,r.useRef)(null),S=(0,r.useRef)(null),E=()=>{var e;null===(e=S.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{E()},[h]);let Z=(0,r.useCallback)(async()=>{try{let e=(0,x.B)();if(!e){b("Supabase not configured"),y(!1);return}let{data:{user:a},error:r}=await e.auth.getUser();if(r||!a){s.push("/login");return}let{data:n,error:l}=await e.from("projects").select("id, name, status, document_count, created_at").eq("id",t).eq("user_id",a.id).single();if(l||!n){b("Project not found or access denied"),y(!1);return}m(n);let{data:i,error:o}=await e.from("project_conversations").select("id, user_message, ai_response, created_at").eq("project_id",t).order("created_at",{ascending:!0});o?console.error("Error loading conversations:",o):g(i||[]),y(!1)}catch(e){console.error("Error loading project:",e),b("Failed to load project"),y(!1)}},[t,s]);(0,r.useEffect)(()=>{Z()},[Z]);let P=async()=>{if(!N.trim()||w||!u)return;_(!0);let e=N.trim();v(""),k.current&&(k.current.style.height="auto");try{let s=await fetch("/api/projects/".concat(t,"/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to send message")}let a=await s.json(),r={id:Date.now().toString(),user_message:e,ai_response:a.response,created_at:new Date().toISOString()};g(e=>[...e,r])}catch(e){console.error("Error sending message:",e),b(e instanceof Error?e.message:"Failed to send message")}finally{_(!1)}};return f?(0,a.jsx)("div",{className:"min-h-screen bg-apple-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(l.Z,{size:48,className:"animate-spin mx-auto mb-4 text-apple-blue-500"}),(0,a.jsx)("p",{className:"text-apple-gray-600",children:"Loading project..."})]})}):j||!u?(0,a.jsx)("div",{className:"min-h-screen bg-apple-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-apple-gray-200 p-8 max-w-md",children:[(0,a.jsx)("p",{className:"text-apple-red-600 mb-4",children:j||"Project not found"}),(0,a.jsxs)(p(),{href:"/",className:"btn-primary inline-flex items-center gap-2",children:[(0,a.jsx)(i.Z,{size:16}),"Back to Home"]})]})})}):(0,a.jsxs)("div",{className:"min-h-screen bg-apple-gray-50 flex flex-col",children:[(0,a.jsx)("div",{className:"bg-white border-b border-apple-gray-200 px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(p(),{href:"/",className:"p-2 hover:bg-apple-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(i.Z,{size:20})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-apple-gray-900",children:u.name}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-apple-gray-600 mt-1",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(o.Z,{size:14}),u.document_count," documents"]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("ready"===u.status?"bg-apple-green-100 text-apple-green-700":"bg-apple-orange-100 text-apple-orange-700"),children:"ready"===u.status?"Ready":"Processing"})]})]})]})}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col max-w-4xl mx-auto w-full",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[0===h.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(c.Z,{size:48,className:"mx-auto mb-4 text-apple-gray-400"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-apple-gray-700 mb-2",children:"Start chatting with your documents"}),(0,a.jsx)("p",{className:"text-apple-gray-500",children:"Ask questions about the content in your uploaded PDFs"})]}):(0,a.jsx)("div",{className:"space-y-6",children:h.map(e=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("div",{className:"bg-apple-blue-500 text-white rounded-2xl rounded-tr-md px-4 py-3 max-w-2xl",children:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:e.user_message})})}),(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-white border border-apple-gray-200 rounded-2xl rounded-tl-md px-4 py-3 max-w-2xl shadow-sm",children:(0,a.jsx)("p",{className:"whitespace-pre-wrap text-apple-gray-800",children:e.ai_response})})})]},e.id))}),(0,a.jsx)("div",{ref:S})]}),(0,a.jsxs)("div",{className:"p-6 bg-white border-t border-apple-gray-200",children:["ready"!==u.status&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-apple-orange-50 border border-apple-orange-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-apple-orange-700",children:"Documents are still being processed. Please wait before sending messages."})}),(0,a.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("textarea",{ref:k,value:N,onChange:e=>{v(e.target.value),k.current&&(k.current.style.height="auto",k.current.style.height="".concat(Math.min(k.current.scrollHeight,120),"px"))},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),P())},placeholder:"ready"===u.status?"Ask a question about your documents...":"Processing documents...",disabled:w||"ready"!==u.status,className:"w-full px-4 py-3 border border-apple-gray-200 rounded-2xl focus:ring-2 focus:ring-apple-blue-500 focus:border-transparent outline-none resize-none transition-colors",rows:1,style:{minHeight:"48px",maxHeight:"120px"}})}),(0,a.jsx)("button",{onClick:P,disabled:!N.trim()||w||"ready"!==u.status,className:"p-3 bg-apple-blue-500 text-white rounded-2xl hover:bg-apple-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex-shrink-0",children:w?(0,a.jsx)(l.Z,{size:20,className:"animate-spin"}):(0,a.jsx)(d.Z,{size:20})})]}),(0,a.jsx)("p",{className:"text-xs text-apple-gray-500 mt-2 text-center",children:"AI responses are based on your uploaded documents"})]})]})]})}},1654:function(e,s,t){"use strict";t.d(s,{B:function(){return i}});var a=t(7440),r=t(5566);let n=r.env.NEXT_PUBLIC_SUPABASE_URL,l=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;function i(){return n&&l?(0,a.eI)(n,l):(console.warn("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables"),null)}}},function(e){e.O(0,[872,951,971,938,744],function(){return e(e.s=62)}),_N_E=e.O()}]);