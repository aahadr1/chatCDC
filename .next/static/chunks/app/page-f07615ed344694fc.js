(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3071:function(e,a,s){Promise.resolve().then(s.bind(s,6225))},6225:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return U}});var t=s(7437),l=s(2265),r=s(1872),n=s(1396),i=s.n(n),o=s(4033),c=s(1654),d=s(9883),p=s(2882),m=s(734),u=s(1138),x=s(9409),g=s(7972),h=s(9168);function b(e){let{conversations:a,currentConversationId:s,settings:r,onNewChat:n,onSelectConversation:b,onDeleteConversation:f,onRenameConversation:j,onOpenSettings:v}=e,[y,N]=l.useState(null),[w,C]=l.useState(""),[k,S]=l.useState([]),[E,z]=l.useState(!1),A=(0,o.useRouter)();l.useEffect(()=>{let e=(0,c.B)();if(!e)return;let a=!0;return z(!0),(async()=>{let{data:{user:s}}=await e.auth.getUser();if(!s){a&&S([]),z(!1);return}let{data:t,error:l}=await e.from("projects").select("id, name").eq("user_id",s.id).order("created_at",{ascending:!1});a&&(l?(console.warn("Failed to load projects",l.message),S([])):S(t||[]),z(!1))})(),()=>{a=!1}},[]);let D=e=>{N(e.id),C(e.title)},Z=()=>{y&&w.trim()&&j(y,w.trim()),N(null),C("")},P=()=>{N(null),C("")},_=e=>{let a=Math.floor((new Date().getTime()-e.getTime())/864e5);return 0===a?"Today":1===a?"Yesterday":a<7?"".concat(a," days ago"):a<30?"".concat(Math.floor(a/7)," weeks ago"):e.toLocaleDateString()};return(0,t.jsxs)("div",{className:"w-80 bg-apple-gray-50 border-r border-apple-gray-200 flex flex-col h-full",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-apple-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-apple-gray-900",children:"ChatCDC"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-apple-green-500 rounded-full animate-pulse-subtle"}),(0,t.jsx)("span",{className:"text-xs text-apple-gray-500 font-medium",children:r.model.toUpperCase()})]})]}),(0,t.jsxs)("button",{onClick:n,className:"w-full btn-primary flex items-center justify-center gap-2 py-3",children:[(0,t.jsx)(d.Z,{size:18}),"New Chat"]}),(0,t.jsx)("div",{className:"mt-3",children:(0,t.jsxs)(i(),{href:"/projects/new",className:"w-full btn-secondary flex items-center justify-center gap-2 py-3 block text-center",children:[(0,t.jsx)(d.Z,{size:18}),"New Project"]})})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-4",children:[(0,t.jsx)("div",{className:"space-y-2",children:0===a.length?(0,t.jsxs)("div",{className:"text-center py-8 text-apple-gray-500",children:[(0,t.jsx)(p.Z,{size:48,className:"mx-auto mb-3 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"No conversations yet"}),(0,t.jsx)("p",{className:"text-xs mt-1",children:"Start a new chat to begin"})]}):a.map(e=>(0,t.jsx)("div",{className:"group relative rounded-xl transition-all duration-200 ".concat(s===e.id?"bg-apple-blue-500 text-white shadow-lg":"hover:bg-white hover:shadow-sm"),children:y===e.id?(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)("input",{type:"text",value:w,onChange:e=>C(e.target.value),onKeyDown:e=>{"Enter"===e.key&&Z(),"Escape"===e.key&&P()},onBlur:Z,className:"w-full bg-transparent border-b border-current outline-none text-sm",autoFocus:!0})}):(0,t.jsx)("div",{onClick:()=>b(e.id),className:"p-3 cursor-pointer",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"font-medium text-sm truncate mb-1",children:e.title}),(0,t.jsxs)("p",{className:"text-xs opacity-70",children:[_(e.updatedAt)," â€¢ ",e.messages.length," messages"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200 ml-2",children:[(0,t.jsx)("button",{onClick:a=>{a.stopPropagation(),D(e)},className:"p-1 rounded hover:bg-black/10 transition-colors duration-200",title:"Rename",children:(0,t.jsx)(m.Z,{size:12})}),(0,t.jsx)("button",{onClick:a=>{a.stopPropagation(),f(e.id)},className:"p-1 rounded hover:bg-black/10 transition-colors duration-200 text-apple-red-500",title:"Delete",children:(0,t.jsx)(u.Z,{size:12})})]})]})})},e.id))}),(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsx)("h2",{className:"text-xs font-semibold uppercase tracking-wider text-apple-gray-500 mb-2",children:"Projects"}),E?(0,t.jsx)("div",{className:"text-xs text-apple-gray-500",children:"Loading projects..."}):0===k.length?(0,t.jsx)("div",{className:"text-xs text-apple-gray-400",children:"No projects yet"}):(0,t.jsx)("div",{className:"space-y-1",children:k.map(e=>(0,t.jsx)("button",{onClick:()=>A.push("/projects/".concat(e.id)),className:"w-full text-left px-3 py-2 rounded-lg hover:bg-white hover:shadow-sm transition",children:(0,t.jsx)("div",{className:"text-sm font-medium text-apple-gray-900 truncate",children:e.name})},e.id))})]})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-apple-gray-200 space-y-2",children:[(0,t.jsxs)("button",{onClick:v,className:"sidebar-item w-full justify-start",children:[(0,t.jsx)(x.Z,{size:18}),(0,t.jsx)("span",{children:"Settings"})]}),(0,t.jsxs)("div",{className:"sidebar-item w-full justify-start",children:[(0,t.jsx)(g.Z,{size:18}),(0,t.jsx)("span",{children:"Profile"})]}),(0,t.jsxs)("div",{className:"sidebar-item w-full justify-start",children:[(0,t.jsx)(h.Z,{size:18}),(0,t.jsx)("span",{children:"Upgrade to Pro"})]})]})]})}var f=s(272),j=s(2369),v=s(3523),y=s(8956);function N(e){let{settings:a,onSettingsChange:s,currentTitle:r}=e,[n,i]=l.useState(!1),[o,c]=l.useState(!1),d=e=>{switch(e){case"gpt-5":default:return(0,t.jsx)(f.Z,{className:"text-purple-500",size:16});case"gpt-5-mini":return(0,t.jsx)(j.Z,{className:"text-blue-500",size:16});case"gpt-5-nano":return(0,t.jsx)(p.Z,{className:"text-green-500",size:16})}};return(0,t.jsx)("header",{className:"bg-white border-b border-apple-gray-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between max-w-full",children:[(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)("h1",{className:"text-lg font-semibold text-apple-gray-900 truncate",children:r||"New Chat"})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>i(!n),className:"flex items-center gap-2 px-3 py-2 bg-apple-gray-100 hover:bg-apple-gray-200 rounded-xl transition-colors duration-200",children:[d(a.model),(0,t.jsx)("span",{className:"font-medium text-sm",children:a.model.toUpperCase()}),(0,t.jsx)(v.Z,{size:16,className:"transition-transform duration-200 ".concat(n?"rotate-180":"")})]}),n&&(0,t.jsx)("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-xl shadow-lg border border-apple-gray-200 py-2 z-50",children:[{id:"gpt-5",name:"GPT-5",description:"Most capable model"},{id:"gpt-5-mini",name:"GPT-5 Mini",description:"Fast and efficient"},{id:"gpt-5-nano",name:"GPT-5 Nano",description:"Ultra-fast responses"}].map(e=>(0,t.jsx)("button",{onClick:()=>{s({...a,model:e.id}),i(!1)},className:"w-full px-4 py-3 text-left hover:bg-apple-gray-50 transition-colors duration-200 ".concat(a.model===e.id?"bg-apple-blue-50 text-apple-blue-600":""),children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[d(e.id),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-apple-gray-500",children:e.description})]})]})},e.id))})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>c(!o),className:"flex items-center gap-2 px-3 py-2 text-apple-gray-600 hover:bg-apple-gray-100 rounded-xl transition-colors duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[a.enableWebSearch&&(0,t.jsx)(y.Z,{size:14,className:"text-apple-blue-500"}),(0,t.jsx)("span",{className:"text-sm font-medium capitalize",children:a.verbosity})]}),(0,t.jsx)(v.Z,{size:16,className:"transition-transform duration-200 ".concat(o?"rotate-180":"")})]}),o&&(0,t.jsx)("div",{className:"absolute top-full right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-apple-gray-200 p-4 z-50",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-apple-gray-700 mb-2",children:"Response Style"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{id:"low",name:"Concise",description:"Short and direct"},{id:"medium",name:"Balanced",description:"Moderate detail"},{id:"high",name:"Detailed",description:"Comprehensive responses"}].map(e=>(0,t.jsxs)("button",{onClick:()=>s({...a,verbosity:e.id}),className:"p-2 rounded-lg text-xs font-medium transition-colors duration-200 ".concat(a.verbosity===e.id?"bg-apple-blue-500 text-white":"bg-apple-gray-100 hover:bg-apple-gray-200 text-apple-gray-700"),children:[(0,t.jsx)("div",{children:e.name}),(0,t.jsx)("div",{className:"text-xs opacity-70",children:e.description})]},e.id))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-apple-gray-700 mb-2",children:"Reasoning Effort"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{id:"minimal",name:"Minimal",description:"Quick responses"},{id:"low",name:"Low",description:"Basic reasoning"},{id:"medium",name:"Medium",description:"Moderate reasoning"},{id:"high",name:"High",description:"Deep reasoning"}].map(e=>(0,t.jsxs)("button",{onClick:()=>s({...a,reasoningEffort:e.id}),className:"p-2 rounded-lg text-xs font-medium transition-colors duration-200 ".concat(a.reasoningEffort===e.id?"bg-apple-blue-500 text-white":"bg-apple-gray-100 hover:bg-apple-gray-200 text-apple-gray-700"),children:[(0,t.jsx)("div",{children:e.name}),(0,t.jsx)("div",{className:"text-xs opacity-70",children:e.description})]},e.id))})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("label",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-apple-gray-700",children:"Web Search"}),(0,t.jsx)("p",{className:"text-xs text-apple-gray-500",children:"Allow access to current information"})]}),(0,t.jsx)("button",{onClick:()=>s({...a,enableWebSearch:!a.enableWebSearch}),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ".concat(a.enableWebSearch?"bg-apple-blue-500":"bg-apple-gray-300"),children:(0,t.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform duration-200 ".concat(a.enableWebSearch?"translate-x-6":"translate-x-1")})})]})})]})})]})]})]})})}var w=s(9868),C=s(4658),k=s(6224),S=s(5432),E=s(5749),z=s(815);function A(e){let{message:a,onFeedback:s,onCopy:l,onRegenerate:r}=e,n="user"===a.role;return a.isTyping?(0,t.jsx)("div",{className:"flex justify-start mb-6",children:(0,t.jsx)("div",{className:"message-bubble assistant-message",children:(0,t.jsxs)("div",{className:"typing-indicator flex gap-1",children:[(0,t.jsx)("span",{className:"w-2 h-2 bg-apple-gray-400 rounded-full"}),(0,t.jsx)("span",{className:"w-2 h-2 bg-apple-gray-400 rounded-full"}),(0,t.jsx)("span",{className:"w-2 h-2 bg-apple-gray-400 rounded-full"})]})})}):(0,t.jsx)("div",{className:"flex ".concat(n?"justify-end":"justify-start"," mb-6 group"),children:(0,t.jsxs)("div",{className:"message-bubble ".concat(n?"user-message":"assistant-message"),children:[a.images&&a.images.length>0&&(0,t.jsx)("div",{className:"mb-3 grid grid-cols-2 gap-2",children:a.images.map((e,a)=>(0,t.jsx)("img",{src:e,alt:"Uploaded image ".concat(a+1),className:"rounded-lg max-w-full h-auto"},a))}),(0,t.jsx)("div",{className:"prose prose-sm max-w-none",children:n?(0,t.jsx)("p",{className:"text-white m-0 whitespace-pre-wrap",children:a.content}):(0,t.jsx)(E.UG,{remarkPlugins:[z.Z],className:"text-apple-gray-900 [&>*:first-child]:mt-0 [&>*:last-child]:mb-0",components:{code(e){let{node:a,inline:s,className:l,children:r,...n}=e;return s?(0,t.jsx)("code",{className:"bg-apple-gray-200 px-1 py-0.5 rounded text-sm",...n,children:r}):(0,t.jsx)("pre",{className:"overflow-auto rounded-lg p-3",children:(0,t.jsx)("code",{className:l,...n,children:r})})},table(e){let{children:a,...s}=e;return(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsx)("table",{className:"min-w-full border-collapse",...s,children:a})})}},children:a.content})}),!n&&(0,t.jsxs)("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-apple-gray-200 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>s(a.id,"up"),className:"p-1.5 rounded-lg transition-colors duration-200 ".concat("up"===a.feedback?"bg-apple-green-500 text-white":"hover:bg-apple-gray-200 text-apple-gray-600"),children:(0,t.jsx)(w.Z,{size:14})}),(0,t.jsx)("button",{onClick:()=>s(a.id,"down"),className:"p-1.5 rounded-lg transition-colors duration-200 ".concat("down"===a.feedback?"bg-apple-red-500 text-white":"hover:bg-apple-gray-200 text-apple-gray-600"),children:(0,t.jsx)(C.Z,{size:14})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>l(a.content),className:"p-1.5 rounded-lg hover:bg-apple-gray-200 text-apple-gray-600 transition-colors duration-200",title:"Copy message",children:(0,t.jsx)(k.Z,{size:14})}),r&&(0,t.jsx)("button",{onClick:()=>r(a.id),className:"p-1.5 rounded-lg hover:bg-apple-gray-200 text-apple-gray-600 transition-colors duration-200",title:"Regenerate response",children:(0,t.jsx)(S.Z,{size:14})})]})]})]})})}function D(e){let{messages:a,isLoading:s,onFeedback:r,onCopy:n,onRegenerate:i}=e,o=(0,l.useRef)(null),c=(0,l.useRef)(null),d=()=>{var e;null===(e=o.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return((0,l.useEffect)(()=>{d()},[a]),0===a.length)?(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-apple-gray-50 to-white",children:(0,t.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-apple-blue-500 to-apple-blue-600 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:(0,t.jsx)("svg",{className:"w-12 h-12 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-apple-gray-900 mb-3",children:"Welcome to ChatCDC"}),(0,t.jsx)("p",{className:"text-apple-gray-600 mb-6 leading-relaxed",children:"Your intelligent AI assistant powered by GPT-5. Ask me anything, upload images, or start a conversation to explore the possibilities."}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl shadow-sm border border-apple-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-apple-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-apple-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,t.jsx)("span",{className:"text-apple-gray-700",children:"Advanced reasoning capabilities"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl shadow-sm border border-apple-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-apple-green-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-apple-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})})}),(0,t.jsx)("span",{className:"text-apple-gray-700",children:"Image analysis and understanding"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white rounded-xl shadow-sm border border-apple-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-apple-red-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-apple-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,t.jsx)("span",{className:"text-apple-gray-700",children:"Code generation and debugging"})]})]})]})}):(0,t.jsx)("div",{className:"flex-1 flex flex-col bg-gradient-to-br from-apple-gray-50 to-white",children:(0,t.jsxs)("div",{ref:c,className:"flex-1 overflow-y-auto custom-scrollbar px-6 py-6",children:[(0,t.jsxs)("div",{className:"max-w-4xl mx-auto",children:[a.map(e=>(0,t.jsx)(A,{message:e,onFeedback:r,onCopy:n,onRegenerate:i},e.id)),s&&(0,t.jsx)(A,{message:{id:"typing",role:"assistant",content:"",timestamp:new Date,isTyping:!0},onFeedback:()=>{},onCopy:()=>{}})]}),(0,t.jsx)("div",{ref:o})]})})}var Z=s(2549),P=s(8438),_=s(6020);function R(e){let{onSendMessage:a,disabled:s=!1,placeholder:r="Type your message...",hasActiveConversation:n=!0,onEnsureConversation:i}=e,[o,c]=(0,l.useState)(""),[d,p]=(0,l.useState)([]),m=(0,l.useRef)(null),u=(0,l.useRef)(null),x=(0,l.useCallback)(e=>{e.preventDefault(),(o.trim()||d.length>0)&&(a(o.trim(),d.length>0?d:void 0),c(""),p([]),m.current&&(m.current.style.height="auto"))},[o,d,a]),g=(0,l.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),x(e))},[x]),h=(0,l.useCallback)(e=>{let a=e.target.value;o||!(a.trim().length>0)||n||null==i||i(),c(a),m.current&&(m.current.style.height="auto",m.current.style.height="".concat(Math.min(m.current.scrollHeight,120),"px"))},[o,n,i]),b=(0,l.useCallback)(e=>{Array.from(e.target.files||[]).forEach(e=>{if(e.type.startsWith("image/")){let a=new FileReader;a.onload=e=>{var a;(null===(a=e.target)||void 0===a?void 0:a.result)&&p(a=>[...a,e.target.result])},a.readAsDataURL(e)}}),u.current&&(u.current.value="")},[]),f=(0,l.useCallback)(e=>{p(a=>a.filter((a,s)=>s!==e))},[]);return(0,t.jsx)("div",{className:"bg-white border-t border-apple-gray-200 p-4",children:(0,t.jsxs)("form",{onSubmit:x,className:"max-w-4xl mx-auto",children:[d.length>0&&(0,t.jsx)("div",{className:"mb-4 flex flex-wrap gap-2",children:d.map((e,a)=>(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:e,alt:"Upload preview ".concat(a+1),className:"w-16 h-16 object-cover rounded-lg border border-apple-gray-200"}),(0,t.jsx)("button",{type:"button",onClick:()=>f(a),className:"absolute -top-2 -right-2 w-6 h-6 bg-apple-red-500 text-white rounded-full flex items-center justify-center hover:bg-apple-red-600 transition-colors duration-200",children:(0,t.jsx)(Z.Z,{size:12})})]},a))}),(0,t.jsxs)("div",{className:"relative flex items-end gap-3 bg-apple-gray-50 rounded-2xl p-3 border border-apple-gray-200 focus-within:border-apple-blue-500 focus-within:ring-2 focus-within:ring-apple-blue-500/20 transition-all duration-200",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.click()},disabled:s,className:"flex-shrink-0 p-2 text-apple-gray-500 hover:text-apple-blue-500 hover:bg-apple-blue-50 rounded-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Upload image",children:(0,t.jsx)(P.Z,{size:20})}),(0,t.jsx)("input",{ref:u,type:"file",accept:"image/*",multiple:!0,onChange:b,className:"hidden"}),(0,t.jsx)("textarea",{ref:m,value:o,onChange:h,onKeyDown:g,placeholder:r,disabled:s,className:"flex-1 bg-transparent border-none outline-none resize-none min-h-[24px] max-h-[120px] text-apple-gray-900 placeholder-apple-gray-500 disabled:opacity-50",rows:1}),(0,t.jsx)("button",{type:"submit",disabled:s||!o.trim()&&0===d.length,className:"flex-shrink-0 p-2 bg-apple-blue-500 text-white rounded-xl hover:bg-apple-blue-600 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-apple-blue-500",children:(0,t.jsx)(_.Z,{size:20})})]}),(0,t.jsx)("div",{className:"mt-2 text-xs text-apple-gray-500 text-center",children:"Press Enter to send, Shift+Enter for new line"})]})})}let T={model:"gpt-5",verbosity:"medium",reasoningEffort:"minimal",enableWebSearch:!1};function U(){let[e,a]=(0,l.useState)([]),[s,n]=(0,l.useState)(null),[i,o]=(0,l.useState)(T),[c,d]=(0,l.useState)(!1),[p,m]=(0,l.useState)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("chatcdc-conversations"),s=localStorage.getItem("chatcdc-settings");if(e)try{let s=JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),messages:e.messages.map(e=>({...e,timestamp:new Date(e.timestamp)}))}));a(s),s.length>0&&n(s[0].id)}catch(e){console.error("Error loading conversations:",e)}if(s)try{o(JSON.parse(s))}catch(e){console.error("Error loading settings:",e)}},[]);let u=(0,l.useCallback)(e=>{localStorage.setItem("chatcdc-conversations",JSON.stringify(e))},[]),x=(0,l.useCallback)(e=>{localStorage.setItem("chatcdc-settings",JSON.stringify(e))},[]),g=(0,l.useCallback)(()=>e.find(e=>e.id===s)||null,[e,s]),h=(0,l.useCallback)(e=>e.split(" ").slice(0,6).join(" ")+(e.split(" ").length>6?"...":""),[]),f=(0,l.useCallback)(()=>{let s={id:(0,r.Z)(),title:"New Chat",messages:[],createdAt:new Date,updatedAt:new Date},t=[s,...e];a(t),n(s.id),m(null),u(t)},[e,u]),j=(0,l.useCallback)(e=>{n(e),m(null)},[]),v=(0,l.useCallback)(t=>{let l=e.filter(e=>e.id!==t);a(l),s===t&&n(l.length>0?l[0].id:null),u(l)},[e,s,u]),y=(0,l.useCallback)((s,t)=>{let l=e.map(e=>e.id===s?{...e,title:t,updatedAt:new Date}:e);a(l),u(l)},[e,u]),w=(0,l.useCallback)(e=>{o(e),x(e)},[x]),C=(0,l.useCallback)(async(s,t)=>{if(!s.trim()&&(!t||0===t.length))return;let l=g();if(!l){let t=[l={id:(0,r.Z)(),title:h(s),messages:[],createdAt:new Date,updatedAt:new Date},...e];a(t),n(l.id),u(t)}let o={id:(0,r.Z)(),role:"user",content:s,timestamp:new Date,images:t},c=0===l.messages.length?h(s):l.title,x={...l,title:c,messages:[...l.messages,o],updatedAt:new Date},b=e.map(e=>e.id===x.id?x:e);a(b),u(b),d(!0);try{let l=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,settings:i,images:t,previousResponseId:p})});if(!l.ok)throw Error("HTTP error! status: ".concat(l.status));let n=await l.json();if(n.error)throw Error(n.error);let o={id:(0,r.Z)(),role:"assistant",content:n.content,timestamp:new Date},c={...x,messages:[...x.messages,o],updatedAt:new Date},d=e.map(e=>e.id===c.id?c:e);a(d),u(d),m(n.responseId)}catch(n){console.error("Error sending message:",n);let s={id:(0,r.Z)(),role:"assistant",content:"Sorry, I encountered an error: ".concat(n instanceof Error?n.message:"Unknown error",". Please try again."),timestamp:new Date},t={...x,messages:[...x.messages,s],updatedAt:new Date},l=e.map(e=>e.id===t.id?t:e);a(l),u(l)}finally{d(!1)}},[g,e,h,u,i,p]),k=(0,l.useCallback)((s,t)=>{let l=e.map(e=>({...e,messages:e.messages.map(e=>e.id===s?{...e,feedback:e.feedback===t?null:t}:e)}));a(l),u(l)},[e,u]),S=(0,l.useCallback)(async e=>{try{await navigator.clipboard.writeText(e)}catch(e){console.error("Failed to copy:",e)}},[]),E=(0,l.useCallback)(async s=>{let t=g();if(!t)return;let l=t.messages.findIndex(e=>e.id===s);if(-1===l||0===l)return;let r=t.messages[l-1];if("user"!==r.role)return;let n=t.messages.slice(0,l),i={...t,messages:n,updatedAt:new Date},o=e.map(e=>e.id===i.id?i:e);a(o),u(o),await C(r.content,r.images)},[g,e,u,C]),z=g(),A=(null==z?void 0:z.messages)||[];return(0,t.jsxs)("div",{className:"flex h-screen bg-white",children:[(0,t.jsx)(b,{conversations:e,currentConversationId:s,settings:i,onNewChat:f,onSelectConversation:j,onDeleteConversation:v,onRenameConversation:y,onOpenSettings:()=>{}}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,t.jsx)(N,{settings:i,onSettingsChange:w,currentTitle:null==z?void 0:z.title}),(0,t.jsx)(D,{messages:A,isLoading:c,onFeedback:k,onCopy:S,onRegenerate:E}),(0,t.jsx)(R,{onSendMessage:C,disabled:c,placeholder:"Type your message...",hasActiveConversation:!!z,onEnsureConversation:f})]})]})}},1654:function(e,a,s){"use strict";s.d(a,{B:function(){return i}});var t=s(7440),l=s(5566);let r=l.env.NEXT_PUBLIC_SUPABASE_URL,n=l.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;function i(){return r&&n?(0,t.eI)(r,n):(console.warn("Missing NEXT_PUBLIC_SUPABASE_URL or NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables"),null)}}},function(e){e.O(0,[872,951,465,971,938,744],function(){return e(e.s=3071)}),_N_E=e.O()}]);